<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n L√Ω B√°c Sƒ© - Admin</title>
    <link rel="stylesheet" href="admin_style.css"> 
    <style>
        /* CSS B·ªë c·ª•c (K·∫ø th·ª´a t·ª´ Dashboard) */
        body { font-family: Arial, sans-serif; background-color: #e9ecef; margin: 0; display: flex; }
        .sidebar { width: 250px; background-color: #343a40; color: white; padding: 20px; height: 100vh; position: fixed; }
        .sidebar a { display: block; padding: 10px; color: #adb5bd; text-decoration: none; border-radius: 4px; margin-bottom: 5px; }
        .sidebar a:hover, .sidebar a.active { background-color: #007bff; color: white; }
        .main-content { margin-left: 250px; flex-grow: 1; padding: 30px; }
        
        /* CSS cho B·∫£ng & C√¥ng c·ª• */
        .management-panel { background-color: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); margin-bottom: 20px; }
        .filter-area { display: flex; gap: 15px; margin-bottom: 20px; align-items: center; }
        .filter-area input, .filter-area select { padding: 10px; border: 1px solid #ccc; border-radius: 4px; }
        .doctor-table th, .doctor-table td { padding: 12px; border-bottom: 1px solid #dee2e6; text-align: left; font-size: 0.9em; }
        .doctor-table { width: 100%; border-collapse: collapse; }
        .status-active { color: green; font-weight: bold; }
        .status-inactive { color: orange; font-weight: bold; }
        .action-btns button { margin-right: 5px; padding: 6px 10px; border: none; border-radius: 4px; cursor: pointer; }
    </style>
</head>
<body>

    <div class="sidebar">
        <h2>üë®‚Äçüíª Admin Panel</h2>
        <p style="color: #6c757d; border-bottom: 1px solid #495057; padding-bottom: 15px; margin-bottom: 15px;">Menu Ch√≠nh</p>
        <a href="admin_dashboard.html">Dashboard & T·ªïng quan</a>
        <a href="admin_manage_doctors.html" class="active">Qu·∫£n l√Ω B√°c sƒ©</a>
        <a href="admin_manage_appointments.html">Qu·∫£n l√Ω L·ªãch h·∫πn</a>
        <a href="admin_reports.html">Th·ªëng k√™ - B√°o c√°o</a>
        <div style="margin-top: 50px;">
            <a href="login_register.html" onclick="logout()" style="background-color: #dc3545; color: white;">ƒêƒÉng Xu·∫•t</a>
        </div>
    </div>

    <div class="main-content">
        <h1>üè• Qu·∫£n L√Ω B√°c Sƒ©</h1>
        <p>Th√™m, s·ª≠a, x√≥a v√† gi√°m s√°t ho·∫°t ƒë·ªông c·ªßa c√°c B√°c sƒ© trong h·ªá th·ªëng.</p>
        
        <div class="management-panel">
            <div style="text-align: right; margin-bottom: 20px;">
                <button onclick="openAddDoctorModal()" style="padding: 10px 20px; background-color: #007bff; color: white; border: none; border-radius: 4px; font-weight: bold; cursor: pointer;">
                    + Th√™m B√°c Sƒ© M·ªõi
                </button>
            </div>

            <div class="filter-area">
                <input type="text" id="search-input" placeholder="T√¨m theo T√™n ho·∫∑c Email...">
                <select id="filter-specialty">
                    <option value="all">T·∫•t c·∫£ Chuy√™n khoa</option>
                    <option value="da_lieu">Da Li·ªÖu</option>
                    <option value="tim_mach">Tim M·∫°ch</option>
                    <option value="nhi">Nhi</option>
                    <option value="nha_khoa">Nha Khoa</option>
                </select>
                <select id="filter-status">
                    <option value="all">T·∫•t c·∫£ Tr·∫°ng th√°i</option>
                    <option value="active">Active</option>
                    <option value="inactive">Inactive</option>
                </select>
                <button onclick="applyFilters()" style="padding: 10px 15px; background-color: #6c757d; color: white; border: none; border-radius: 4px;">L·ªçc</button>
            </div>

            <table class="doctor-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>H·ªç T√™n</th>
                        <th>Email</th>
                        <th>Chuy√™n Khoa</th>
                        <th>Rating TB</th>
                        <th>Tr·∫°ng Th√°i</th>
                        <th>H√†nh ƒê·ªông</th>
                    </tr>
                </thead>
                <tbody id="doctor-list">
                    </tbody>
            </table>

            <div style="margin-top: 20px; text-align: center;">
                <button disabled style="padding: 8px 15px;">&laquo; Tr∆∞·ªõc</button>
                <span style="margin: 0 10px;">Trang 1 / 5</span>
                <button style="padding: 8px 15px;">Sau &raquo;</button>
            </div>

        </div>

    </div>

    <div id="doctor-modal" style="display:none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); justify-content: center; align-items: center;">
        <div style="background: white; padding: 30px; border-radius: 8px; max-width: 500px; width: 100%;">
            <h2 id="modal-title">Th√™m B√°c Sƒ© M·ªõi</h2>
            <div class="form-group"><label>H·ªç T√™n:</label><input type="text" id="modal-name"></div>
            <div class="form-group"><label>Email:</label><input type="email" id="modal-email"></div>
            <div class="form-group"><label>Chuy√™n Khoa:</label>
                <select id="modal-specialty">
                    <option value="da_lieu">Da Li·ªÖu</option>
                    <option value="tim_mach">Tim M·∫°ch</option>
                    <option value="nhi">Nhi</option>
                </select>
            </div>
            <div class="form-group"><label>M·∫≠t kh·∫©u t·∫°m:</label><input type="password" id="modal-password"></div>
            
            <div style="text-align: right; margin-top: 20px;">
                <button onclick="saveDoctor()" style="background-color: #28a745; color: white; padding: 10px 15px;">L∆∞u</button>
                <button onclick="closeDoctorModal()" style="margin-left: 10px; padding: 10px 15px;">H·ªßy</button>
            </div>
        </div>
    </div>


    <script>
        // D·ªØ li·ªáu gi·∫£ l·∫≠p (mock data)
        let doctorsData = [
            { id: 101, name: 'BS. Nguy·ªÖn VƒÉn Kh·ªèe', email: 'kh·ªèe@hospital.com', specialty: 'Da Li·ªÖu', rating: 4.8, status: 'active' },
            { id: 102, name: 'BS. Tr·∫ßn Th·ªã Linh', email: 'linh@clinic.com', specialty: 'Nhi', rating: 4.9, status: 'active' },
            { id: 103, name: 'BS. Ph·∫°m VƒÉn An', email: 'an@vietduc.com', specialty: 'Tim M·∫°ch', rating: 4.5, status: 'inactive' },
            { id: 104, name: 'BS. L√™ H·∫£i V√¢n', email: 'van@medical.com', specialty: 'Nha Khoa', rating: 4.7, status: 'active' },
            // ... th√™m d·ªØ li·ªáu gi·∫£ l·∫≠p kh√°c ...
        ];
        
        let editingDoctorId = null; // D√πng ƒë·ªÉ x√°c ƒë·ªãnh ch·∫ø ƒë·ªô Th√™m hay S·ª≠a

        // --- H√†m T·∫£i v√† Hi·ªÉn th·ªã B√°c sƒ© ---
        function renderDoctorList(data) {
            const tbody = document.getElementById('doctor-list');
            tbody.innerHTML = ''; 

            data.forEach(doctor => {
                const statusClass = 'status-' + doctor.status;
                const statusLabel = doctor.status === 'active' ? 'Ho·∫°t ƒë·ªông' : 'V√¥ hi·ªáu h√≥a';
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${doctor.id}</td>
                    <td>${doctor.name}</td>
                    <td>${doctor.email}</td>
                    <td>${getSpecialtyLabel(doctor.specialty)}</td>
                    <td>${doctor.rating} ‚≠ê</td>
                    <td class="${statusClass}">${statusLabel}</td>
                    <td class="action-btns">
                        <button onclick="editDoctor(${doctor.id})" style="background-color: #ffc107;">S·ª≠a</button>
                        <button onclick="toggleStatus(${doctor.id}, '${doctor.status}')" style="background-color: ${doctor.status === 'active' ? '#dc3545' : '#28a745'}; color: white;">
                            ${doctor.status === 'active' ? 'V√¥ hi·ªáu h√≥a' : 'K√≠ch ho·∫°t'}
                        </button>
                        <button onclick="deleteDoctor(${doctor.id})" style="background-color: #6c757d; color: white;">X√≥a</button>
                    </td>
                `;
            });

            if (data.length === 0) {
                 tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 20px;">Kh√¥ng t√¨m th·∫•y B√°c sƒ© n√†o ph√π h·ª£p.</td></tr>';
            }
        }

        function getSpecialtyLabel(key) {
             const specialties = { 'da_lieu': 'Da Li·ªÖu', 'tim_mach': 'Tim M·∫°ch', 'nhi': 'Nhi', 'nha_khoa': 'Nha Khoa' };
             return specialties[key] || key;
        }

        // --- H√†m L·ªçc & T√¨m ki·∫øm ---
        function applyFilters() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            const filterSpecialty = document.getElementById('filter-specialty').value;
            const filterStatus = document.getElementById('filter-status').value;

            const filteredList = doctorsData.filter(doctor => {
                const searchMatch = doctor.name.toLowerCase().includes(searchTerm) || doctor.email.toLowerCase().includes(searchTerm);
                const specialtyMatch = filterSpecialty === 'all' || doctor.specialty === filterSpecialty;
                const statusMatch = filterStatus === 'all' || doctor.status === filterStatus;
                return searchMatch && specialtyMatch && statusMatch;
            });

            renderDoctorList(filteredList);
        }

        // --- H√†m Qu·∫£n l√Ω (CRUD Actions) ---

        function openAddDoctorModal() {
            editingDoctorId = null;
            document.getElementById('modal-title').textContent = 'Th√™m B√°c Sƒ© M·ªõi';
            // Reset fields
            document.getElementById('modal-name').value = '';
            document.getElementById('modal-email').value = '';
            document.getElementById('modal-password').value = '';
            document.getElementById('modal-specialty').value = 'da_lieu';
            document.getElementById('doctor-modal').style.display = 'flex';
        }

        function editDoctor(id) {
            editingDoctorId = id;
            const doctor = doctorsData.find(d => d.id === id);
            if (doctor) {
                document.getElementById('modal-title').textContent = 'S·ª≠a Th√¥ng Tin B√°c Sƒ©';
                document.getElementById('modal-name').value = doctor.name;
                document.getElementById('modal-email').value = doctor.email;
                document.getElementById('modal-specialty').value = doctor.specialty;
                document.getElementById('modal-password').value = ''; // Kh√¥ng ƒëi·ªÅn m·∫≠t kh·∫©u c≈©
                document.getElementById('doctor-modal').style.display = 'flex';
            }
        }
        
        function closeDoctorModal() {
             document.getElementById('doctor-modal').style.display = 'none';
        }

        function saveDoctor() {
            const name = document.getElementById('modal-name').value;
            const email = document.getElementById('modal-email').value;
            const specialty = document.getElementById('modal-specialty').value;
            const password = document.getElementById('modal-password').value; // Ch·ªâ c·∫ßn cho Th√™m m·ªõi/ƒê·ªïi m·∫≠t kh·∫©u

            if (!name || !email || !specialty) {
                alert('Vui l√≤ng ƒëi·ªÅn ƒë·ªß th√¥ng tin b·∫Øt bu·ªôc.');
                return;
            }

            if (editingDoctorId) {
                // Logic S·ª≠a
                console.log(`API Call: C·∫≠p nh·∫≠t BS ID ${editingDoctorId}`);
                alert(`ƒê√£ c·∫≠p nh·∫≠t th√¥ng tin cho BS ${name}.`);
                // C·∫≠p nh·∫≠t mock data (gi·∫£ l·∫≠p)
                const docIndex = doctorsData.findIndex(d => d.id === editingDoctorId);
                doctorsData[docIndex] = { ...doctorsData[docIndex], name, email, specialty };
            } else {
                // Logic Th√™m m·ªõi
                 if (!password) { alert('Vui l√≤ng ƒë·∫∑t m·∫≠t kh·∫©u t·∫°m cho B√°c sƒ© m·ªõi.'); return; }
                const newId = Math.max(...doctorsData.map(d => d.id)) + 1;
                doctorsData.push({ id: newId, name, email, specialty, rating: 0, status: 'active' });
                console.log(`API Call: Th√™m BS m·ªõi ID ${newId}`);
                alert(`ƒê√£ th√™m BS ${name} v√†o h·ªá th·ªëng.`);
            }

            closeDoctorModal();
            applyFilters(); // Hi·ªÉn th·ªã l·∫°i danh s√°ch
        }

        function toggleStatus(id, currentStatus) {
            const newStatus = currentStatus === 'active' ? 'inactive' : 'active';
            if (confirm(`B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ${newStatus === 'inactive' ? 'V√î HI·ªÜU H√ìA' : 'K√çCH HO·∫†T'} t√†i kho·∫£n BS ID ${id} kh√¥ng?`)) {
                 console.log(`API Call: C·∫≠p nh·∫≠t tr·∫°ng th√°i BS ID ${id} th√†nh ${newStatus}`);
                 // C·∫≠p nh·∫≠t mock data
                 const doctor = doctorsData.find(d => d.id === id);
                 if (doctor) doctor.status = newStatus;
                 applyFilters();
            }
        }
        
        function deleteDoctor(id) {
             if (confirm(`B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën X√ìA Vƒ®NH VI·ªÑN BS ID ${id} kh√¥ng? (N√™n d√πng V√¥ hi·ªáu h√≥a)`)) {
                 console.log(`API Call: X√≥a BS ID ${id}`);
                 // C·∫≠p nh·∫≠t mock data
                 doctorsData = doctorsData.filter(d => d.id !== id);
                 applyFilters();
                 alert(`ƒê√£ x√≥a BS ID ${id}.`);
            }
        }

        function logout() {
            console.log('ƒêƒÉng xu·∫•t Admin');
            // window.location.href = 'login_register.html';
        }

        // Kh·ªüi ch·∫°y khi t√†i li·ªáu t·∫£i xong
        document.addEventListener('DOMContentLoaded', () => {
             renderDoctorList(doctorsData);
        });
    </script>
</body>
</html>